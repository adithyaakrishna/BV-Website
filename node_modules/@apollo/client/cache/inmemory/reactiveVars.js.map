{"version":3,"file":"reactiveVars.js","sources":["reactiveVars.js"],"sourcesContent":["import { Slot } from \"@wry/context\";\nimport { dep } from \"optimism\";\nvar varDep = dep();\nexport var cacheSlot = new Slot();\nexport function makeVar(value) {\n    var caches = new Set();\n    return function rv(newValue) {\n        if (arguments.length > 0) {\n            if (value !== newValue) {\n                value = newValue;\n                varDep.dirty(rv);\n                caches.forEach(broadcast);\n            }\n        }\n        else {\n            var cache = cacheSlot.getValue();\n            if (cache)\n                caches.add(cache);\n            varDep(rv);\n        }\n        return value;\n    };\n}\nfunction broadcast(cache) {\n    if (cache.broadcastWatches) {\n        cache.broadcastWatches();\n    }\n}\n//# sourceMappingURL=reactiveVars.js.map"],"names":[],"mappings":";;;AAEA,IAAI,MAAM,GAAG,GAAG,EAAE,CAAC;AACT,IAAC,SAAS,GAAG,IAAI,IAAI,GAAG;AAC3B,SAAS,OAAO,CAAC,KAAK,EAAE;AAC/B,IAAI,IAAI,MAAM,GAAG,IAAI,GAAG,EAAE,CAAC;AAC3B,IAAI,OAAO,SAAS,EAAE,CAAC,QAAQ,EAAE;AACjC,QAAQ,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;AAClC,YAAY,IAAI,KAAK,KAAK,QAAQ,EAAE;AACpC,gBAAgB,KAAK,GAAG,QAAQ,CAAC;AACjC,gBAAgB,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;AACjC,gBAAgB,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;AAC1C,aAAa;AACb,SAAS;AACT,aAAa;AACb,YAAY,IAAI,KAAK,GAAG,SAAS,CAAC,QAAQ,EAAE,CAAC;AAC7C,YAAY,IAAI,KAAK;AACrB,gBAAgB,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;AAClC,YAAY,MAAM,CAAC,EAAE,CAAC,CAAC;AACvB,SAAS;AACT,QAAQ,OAAO,KAAK,CAAC;AACrB,KAAK,CAAC;AACN,CAAC;AACD,SAAS,SAAS,CAAC,KAAK,EAAE;AAC1B,IAAI,IAAI,KAAK,CAAC,gBAAgB,EAAE;AAChC,QAAQ,KAAK,CAAC,gBAAgB,EAAE,CAAC;AACjC,KAAK;AACL;;;;"}